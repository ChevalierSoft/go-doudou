{{`{{`}}define "NoneZeroSet"{{`}}`}}
	{{- range $i, $co := .UpdateColumns}}
	{{- if or (eq $co.Meta.Type "time.Time") (eq $co.Meta.Type "*time.Time")}}
	{{`{{`}}- if .{{$co.Meta.Name}}{{`}}`}}
	`{{$co.Name}}`='{{`{{`}}.{{$co.Meta.Name}} | FormatTime{{`}}`}}',
	{{`{{`}}- end{{`}}`}}
	{{- else if or (eq $co.Meta.Type "bool") (eq $co.Meta.Type "*bool")}}
	{{`{{`}}- if .{{$co.Meta.Name}}{{`}}`}}
	`{{$co.Name}}`='{{`{{`}}.{{$co.Meta.Name}} | BoolToInt{{`}}`}}',
	{{`{{`}}- end{{`}}`}}
	{{- else}}
	{{`{{`}}- if .{{$co.Meta.Name}}{{`}}`}}
	`{{$co.Name}}`='{{`{{`}}.{{$co.Meta.Name}}{{`}}`}}',
	{{`{{`}}- end{{`}}`}}
	{{- end}}
	{{- end}}
{{`{{`}}end{{`}}`}}

{{`{{`}}define "Insert{{.DomainName}}"{{`}}`}}
INSERT INTO `{{.Schema}}`.`{{.DomainName | ToSnake}}s`
({{- range $i, $co := .InsertColumns}}
{{- if $i}},{{end}}
`{{$co.Name}}`
{{- end }})
VALUES ({{- range $i, $co := .InsertColumns}}
	   {{- if $i}},{{end}}
	   :{{$co.Name}}
	   {{- end }})
{{`{{`}}end{{`}}`}}

{{`{{`}}define "Update{{.DomainName}}"{{`}}`}}
UPDATE `{{.Schema}}`.`{{.DomainName | ToSnake}}s`
SET
	{{- range $i, $co := .UpdateColumns}}
	{{- if $i}},{{end}}
	`{{$co.Name}}`=:{{$co.Name}}
	{{- end }}
WHERE
    `{{.Pk.Name}}` = ?
{{`{{`}}end{{`}}`}}

{{`{{`}}define "Update{{.DomainName}}NoneZero"{{`}}`}}
UPDATE `{{.Schema}}`.`{{.DomainName | ToSnake}}s`
SET
    {{`{{`}}Eval "NoneZeroSet" . | TrimSuffix ","{{`}}`}}
WHERE
    `{{.Pk.Name}}`='{{.ID}}'
{{`{{`}}end{{`}}`}}

{{`{{`}}define "Upsert{{.DomainName}}"{{`}}`}}
INSERT INTO `{{.Schema}}`.`{{.DomainName | ToSnake}}s`
({{- range $i, $co := .InsertColumns}}
{{- if $i}},{{end}}
`{{$co.Name}}`
{{- end }})
VALUES ({{- range $i, $co := .InsertColumns}}
        {{- if $i}},{{end}}
        :{{$co.Name}}
        {{- end }})
ON DUPLICATE KEY
    UPDATE {{- range $i, $co := .UpdateColumns}}
		   {{- if $i}},{{end}}
		   `{{$co.Name}}`=:{{$co.Name}}
		   {{- end }}
{{`{{`}}end{{`}}`}}

{{`{{`}}define "Get{{.DomainName}}"{{`}}`}}
select *
from `{{.Schema}}`.`{{.DomainName | ToSnake}}s`
where `{{.Pk.Name}}` = ?
{{`{{`}}end{{`}}`}}



